(()=>{function e(e,t){const n=Math.round((new Date).getTime()/1e3),o=a(e),r=a(t);return o===r?o:t<n?`${o} until further notice`:`${o} to ${r}`}function t(e){if(""===e)return"";let t="";return t=e.replaceAll(/NB/g,"Northbound"),t=t.replaceAll(/SB/g,"Southbound"),t=t.replaceAll(/EB/g,"Eastbound"),t=t.replaceAll(/WB/g,"Westbound"),t=t.replaceAll(/ Ave?\b/gm," Avenue"),t=t.replaceAll(/ St\b/gm," Street"),t=t.replaceAll(/ Pl\b/gm," Place"),t=t.replaceAll(/ Rd\b/gm," Road"),t=t.replaceAll(/ Pkwy\b/gm," Parkway"),t=t.replaceAll(/ Blvd\b/gm," Boulevard"),t=t.replaceAll(/ Lk\b/gm," Lake"),t=t.replaceAll(/ Samm\b/gm," Sammamish"),t}function n(e){return"New"===e||e.includes("Ongoing")?"ongoing":"upcoming"}function a(e){return new Date(1e3*e).toLocaleDateString()}window.addEventListener("DOMContentLoaded",(async function(){let a="/sitecore/content/KCGov/home/depts/metro/schedules-maps/241";a="/sitecore/content/KCGov/home/depts/metro/schedules-maps/c-line.html";const o=document.getElementById("accordion"),r="http://3.228.90.146:8090/developer/api/v2",c="4oJedLBt80WP-d7E6Ekf5w",s=function(e){let t=[];return e[0].charAt(0).match(/[a-z]/i)?(e.includes(".html")&&(e=e.replace(".html","")),t[0]=e.replaceAll("-"," ")):(t=e.match(/(\d+)/g),t=t.map((e=>e.replaceAll(/^0+/g,"")))),t}("/sitecore/content/KCGov/home/depts/metro/schedules-maps/c-line.html".split("/").pop()),l=await Promise.all(s.map((async e=>await async function(e,t,n){return(await fetch(`${e}/routes?api_key=${t}`).then((e=>e.json()))).mode[1].route.find((e=>e.route_name.toLowerCase()===n)).route_id}(r,c,e)))),i=await Promise.all(l.map((async e=>await async function(e,t,n){return await fetch(`${e}/alertsbyroute?api_key=${t}&route=${n}`).then((e=>e.json()))}(r,c,e))));let u=!1;if(i.forEach((e=>{e.alerts.length>0&&(u=!0)})),!u)return;let d=new DocumentFragment;d.append(function(a){const o=document.createElement("div");o.setAttribute("class","toggle advisory-block");const r=document.createElement("input");r.id="toggle-advisory",r.setAttribute("type","checkbox"),r.setAttribute("name","advisory"),r.setAttribute("aria-hidden","true");const c=document.createElement("label");c.setAttribute("for","toggle-advisory"),c.setAttribute("class","toggle-head advisory-block-title with-description"),c.textContent="Service Advisory";const s=document.createElement("span");s.setAttribute("class","route-status");const l=function(e){let t=0,n=0;return e.forEach((e=>{e.alerts.forEach((e=>{"Upcoming"===e.alert_lifecycle?n++:t++}))})),{ongoing:t,upcoming:n}}(a);if(l.ongoing>0){const e=document.createElement("span");e.textContent=l.ongoing,e.setAttribute("class","ongoing"),s.append(e)}if(l.upcoming>0){const e=document.createElement("span");e.textContent=l.upcoming,e.setAttribute("class","upcoming"),s.append(e)}return c.append(s),o.append(r,c,function(a){const o=document.createElement("div");o.setAttribute("class","toggle-inner");const r=a.length>1;return a.forEach(((a,c)=>{o.append(function(a,o,r){const c=new DocumentFragment;if(r&&a.alerts.length>0){const e=document.createElement("h3");e.setAttribute("class","route-header"),e.textContent=a.route_name,c.append(e)}return a.alerts.forEach(((a,r)=>{c.append(function(a,o,r){const c=document.createElement("div");c.setAttribute("class",`advisory-content ${function(e){let t;switch(e){case"Trip Cancelation":case"Suspension":t="error";break;case"Trip Restoration":t="task_alt";break;case"Stop Closure":t="dangerous";break;case"Multi-route Reroute":case"Single Route Reroute":t="alt_route";break;case"Delay of Service":t="timer";break;case"ESN":case"Emergency Snow Network":t="ac_unit";break;default:t="warning"}return t}(a.effect_name)}`);const s=document.createElement("h4");s.setAttribute("class","advisory-type"),s.textContent=a.effect_name;const l=document.createElement("span");l.setAttribute("class",`advisory-status ${n(a.alert_lifecycle)}`),l.textContent=n(a.alert_lifecycle),s.append(l);const i=document.createElement("p");i.setAttribute("class","advisory-title"),i.textContent=t(a.header_text);const u=document.createElement("div");u.setAttribute("class","toggle-link");const d=document.createElement("input");d.id=`detail-${r}-${o}`,d.setAttribute("type","checkbox"),d.setAttribute("name","details"),d.setAttribute("aria-hidden","true");const m=document.createElement("label");m.setAttribute("for",`detail-${r}-${o}`),m.setAttribute("class","toggle-link-label"),m.setAttribute("aria-hidden","true");let p="";a.description_text&&(p=document.createElement("p"),p.setAttribute("class","advisory-detail"),p.textContent=t(a.description_text)),u.append(d,m,p);const f=document.createElement("p");f.setAttribute("class","advisory-dates"),a.effect_periods.length>1?f.textContent=function(t){let n="Effective Dates: ";for(let a=0;a<t.length;a++)a===t.length-1?n+=`and ${e(t[a].effect_start,t[a].effect_end)}`:n+=`${e(t[a].effect_start,t[a].effect_end)}, `;return n}(a.effect_periods):1===a.effect_periods.length&&(f.textContent=`Effective Dates: ${e(a.effect_periods[0].effect_start,a.effect_periods[0].effect_end)}`);const g=document.createElement("p");return g.setAttribute("class","alert-footer"),g.textContent=`Alert ID: ${a.alert_id}, Last Updated: ${e(a.last_modified_dt,a.last_modified_dt)}`,c.append(s,i,u,f,g),c}(a,r,o))})),c}(a,c,r))})),o}(a)),o}(i)),o.append(d)}))})();